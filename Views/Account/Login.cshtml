@model MovieTheater.ViewModels.LoginViewModel

@{
    ViewData["Title"] = "Login";
}

<link rel="stylesheet" href="~/css/loginstyle.css" asp-append-version="true" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

<style>
    /* Google Material Button Styles */
    .gsi-material-button {
        background-color: transparent;
        border: 1px solid var(--input-border, #ced4da);
        color: var(--input-color, #212529);
        cursor: pointer;
        display: flex;
        align-items: center;
        font-family: Roboto, sans-serif;
        font-size: 14px;
        height: 40px;
        width: 100%;
        padding: 0;
        text-decoration: none;
        transition: background-color 0.2s, color 0.2s;
    }
    .gsi-material-button:hover {
        background-color: var(--input-bg);
    }
    .gsi-material-button-icon {
        padding: 8px;
    }

    .gsi-material-button-contents {
        flex-grow: 1;
        text-align: center;
        font-weight: 500;
    }

    .gsi-material-button svg {
        height: 18px;
        width: 18px;
    }

    /* Toast Message Styles */
    .toast-message {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 15px 25px;
        border-radius: 4px;
        color: white;
        font-weight: 500;
        z-index: 1000;
        display: none;
        animation: slideIn 0.5s ease-out;
    }

    .toast-success {
        background-color: var(--badge-primary-bg);
    }

    .toast-error {
        background-color: var(--badge-danger-bg);
    }

    .login-main-container {
        display: flex;
        min-height: 100vh;
        align-items: stretch;
        justify-content: center;
        background: var(--body-bg, #fcfbf7);
    }
    .login-left, .login-right {
        width: 50%;
        min-width: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 0 32px;
        box-sizing: border-box;
        min-height: 100vh;
    }
    .login-left {
        background: var(--container-bg, #fcfbf7);
        transition: background 0.3s;
    }
    body.dark-mode .login-left {
        background: var(--dark-bg, #18181a);
    }
    .login-right {
        background: var(--body-bg, #fcfbf7);
        transition: background 0.3s;
    }
    body.dark-mode .login-right {
        background: var(--dark-bg, #18181a);
    }
    .movie-slider-container {
        position: relative;
        width: 520px;
        height: 750px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: transparent;
    }
    .movie-slider-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 18px;
        box-shadow: 0 4px 24px rgba(0,0,0,0.13);
        background: #eee;
        transition: opacity 0.5s;
        opacity: 1;
    }
    .movie-slider-img.hide {
        opacity: 0;
    }
    .slider-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(0,0,0,0.25);
        border: none;
        color: #fff;
        font-size: 2rem;
        width: 44px;
        height: 44px;
        border-radius: 50%;
        cursor: pointer;
        z-index: 2;
        transition: background 0.2s;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .slider-btn:hover {
        background: rgba(0,0,0,0.45);
    }
    .slider-btn.left { left: 10px; }
    .slider-btn.right { right: 10px; }
    .slider-indicators {
        position: absolute;
        bottom: 18px;
        left: 0; right: 0;
        display: flex;
        justify-content: center;
        gap: 8px;
    }
    .slider-dot {
        width: 10px; height: 10px;
        border-radius: 50%;
        background: #bbb;
        opacity: 0.5;
        transition: background 0.2s, opacity 0.2s;
        cursor: pointer;
    }
    .slider-dot.active {
        background: #e50914;
        opacity: 1;
    }
    @@media (max-width: 900px) {
        .login-main-container {
            flex-direction: column;
        }
        .login-left, .login-right {
            width: 100%;
            min-width: 0;
            padding: 0 10px;
        }
        .login-claude-header { margin-top: 18px; margin-bottom: 12px; }
        .login-title-big { font-size: 2.1rem; }
        .login-logo-img { width: 40px; height: 40px; }
        .login-card-claude { padding: 1.5rem 1rem; }
    }
    @@media (max-width: 600px) {
        .login-claude-header { margin-top: 10px; margin-bottom: 8px; }
        .login-title-big { font-size: 1.2rem; }
        .login-card-claude { padding: 1rem 0.5rem; }
    }
    .login-claude-header {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 40px;
        margin-bottom: 48px;
        width: 100%;
    }
    .login-logo-img {
        width: 56px;
        height: 56px;
        object-fit: contain;
        margin-bottom: 2.2rem;
        border-radius: 50%;
        background: #fff;
        box-shadow: 0 2px 12px rgba(0,0,0,0.07);
    }
    body.dark-mode .login-logo-img {
        background: #232336;
        box-shadow: 0 2px 12px rgba(99,102,241,0.13);
    }
    .login-title-big {
        font-size: 3rem;
        font-family: 'Georgia', serif;
        font-weight: 600;
        color: #18181a;
        text-align: center;
        margin-bottom: 1.1rem;
        line-height: 1.1;
        transition: color 0.3s;
    }
    body.dark-mode .login-title-big {
        color: #e2e8f0;
    }
    .login-desc {
        font-size: 1.15rem;
        color: #444;
        text-align: center;
        margin-bottom: 2.5rem;
        font-family: 'Poppins', sans-serif;
        transition: color 0.3s;
    }
    body.dark-mode .login-desc {
        color: #b3b3c6;
    }
    .login-card-claude {
        background: #fff;
        border-radius: 24px;
        box-shadow: 0 4px 32px rgba(0,0,0,0.08);
        padding: 2.5rem 2.2rem 2.2rem 2.2rem;
        width: 100%;
        max-width: 400px;
        display: flex;
        flex-direction: column;
        align-items: center;
        transition: background 0.3s, box-shadow 0.3s;
    }
    body.dark-mode .login-card-claude {
        background: var(--card-bg, #232336);
        box-shadow: 0 4px 32px rgba(99,102,241,0.13);
    }
    .login-title {
        margin-bottom: 1.5rem;
        text-align: center;
        font-weight: bold;
        font-size: 2.1rem;
        color: #2c3e50;
        letter-spacing: 1px;
        font-family: 'Montserrat', 'Poppins', sans-serif;
        transition: color 0.3s;
    }
    body.dark-mode .login-title {
        color: #e2e8f0;
    }
    .form-control {
        border-radius: 10px;
        border: 1.5px solid #e0e0e0;
        padding: 0.7rem 1rem;
        font-size: 1.08rem;
        margin-bottom: 0.5rem;
        background: #fff;
        color: #18181a;
        transition: background 0.3s, color 0.3s, border-color 0.3s;
    }
    body.dark-mode .form-control {
        background: #232336;
        color: #e2e8f0;
        border-color: #6366f1;
    }
    .btn-primary {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        border: none;
        padding: 0.6rem;
        font-size: 1rem;
        border-radius: 6px;
        transition: all 0.3s ease;
    }
    body.dark-mode .btn-primary {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        color: #fff;
    }
    .form-control::placeholder {
        color: #888;         /* Màu placeholder ở light mode */
        opacity: 1;          /* Đảm bảo không bị mờ */
    }

    body.dark-mode .form-control::placeholder {
        color: #b3b3c6;      /* Màu placeholder ở dark mode */
        opacity: 1;
    }
</style>

<div class="login-main-container">
    <div class="login-left">
        <div class="login-claude-header">
            <img class="login-logo-img" src="https://png.pngtree.com/png-clipart/20240701/original/pngtree-judging-cat-meme-sticker-illustration-png-image_15457509.png" alt="Logo" />
            <div class="login-title-big">Good Movie,<br>Good Price</div>
            <div class="login-desc">A Cinematic Experience Crafted for You.</div>
        </div>
        <div class="login-card-claude">
            <!--<h2 class="login-title">Login</h2>-->
            <form id="loginForm" asp-action="Login" method="post">
                <div class="form-group">
                    <input type="text" class="form-control" asp-for="Username" placeholder="Username" required />
                </div>
                <div class="form-group">
                    <input type="password" class="form-control" asp-for="Password" placeholder="Password" required />
                </div>
                <button type="submit" class="btn btn-primary w-100 mt-3">Login</button>
                <!-- Google Material–style Login Button -->
                <a href="/Account/ExternalLogin" class="gsi-material-button mt-2">
                    <div class="gsi-material-button-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                            <path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z" />
                            <path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z" />
                            <path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z" />
                            <path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z" />
                        </svg>
                    </div>
                    <span class="gsi-material-button-contents">Sign in with Google</span>
                </a>
                <p class="mt-3 text-center">
                    Don't have an account? <a asp-action="Signup" asp-controller="Account">Sign up</a>
                </p>
            </form>
        </div>
    </div>
    <div class="login-right">
        <div class="movie-slider-container">
            <button class="slider-btn left" id="sliderPrev" aria-label="Previous">&#8592;</button>
            <img id="sliderImg" class="movie-slider-img" src="" alt="Movie Poster" style="display:none;" />
            <button class="slider-btn right" id="sliderNext" aria-label="Next">&#8594;</button>
            <div class="slider-indicators" id="sliderIndicators"></div>
        </div>
    </div>
</div>

<partial name="_ToastMessages" />

<script>
    let posters = [];
    let current = 0;
    let autoSlideInterval = null;

    function showSlide(idx) {
        if (!posters.length) return;
        const img = document.getElementById('sliderImg');
        img.classList.add('hide');
        setTimeout(() => {
            img.src = posters[idx];
            img.style.display = 'block';
            img.classList.remove('hide');
        }, 200);
        // Update indicators
        const dots = document.querySelectorAll('.slider-dot');
        dots.forEach((dot, i) => dot.classList.toggle('active', i === idx));
    }

    function nextSlide() {
        current = (current + 1) % posters.length;
        showSlide(current);
    }
    function prevSlide() {
        current = (current - 1 + posters.length) % posters.length;
        showSlide(current);
    }
    function goToSlide(idx) {
        current = idx;
        showSlide(current);
    }
    function startAutoSlide() {
        if (autoSlideInterval) clearInterval(autoSlideInterval);
        autoSlideInterval = setInterval(nextSlide, 3500);
    }

    fetch('/Movie/MovieList', { headers: { 'X-Requested-With': 'XMLHttpRequest' } })
        .then(res => res.text())
        .then(html => {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            posters = Array.from(tempDiv.querySelectorAll('img')).map(img => img.src);
            if (!posters.length) return;
            // Render indicators
            const indicators = document.getElementById('sliderIndicators');
            indicators.innerHTML = '';
            posters.forEach((_, i) => {
                const dot = document.createElement('div');
                dot.className = 'slider-dot' + (i === 0 ? ' active' : '');
                dot.onclick = () => { goToSlide(i); startAutoSlide(); };
                indicators.appendChild(dot);
            });
            // Show first slide
            current = 0;
            showSlide(current);
            startAutoSlide();
        });

    document.getElementById('sliderPrev').onclick = function() { prevSlide(); startAutoSlide(); };
    document.getElementById('sliderNext').onclick = function() { nextSlide(); startAutoSlide(); };
</script>
