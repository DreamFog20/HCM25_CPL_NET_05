@model MovieTheater.ViewModels.ForgetPasswordViewModel

@{
    ViewData["Title"] = "Quên Mật Khẩu";
}

<link rel="stylesheet" href="~/css/loginstyle.css" asp-append-version="true" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

<style>
    .login-main-container {
        display: flex;
        min-height: 100vh;
        align-items: stretch;
        justify-content: center;
        background: var(--body-bg, #fcfbf7);
    }
    .login-left, .login-right {
        width: 50%;
        min-width: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 0 32px;
        box-sizing: border-box;
        min-height: 100vh;
    }
    .login-left {
        background: var(--container-bg, #fcfbf7);
        transition: background 0.3s;
    }
    body.dark-mode .login-left {
        background: var(--dark-bg, #18181a);
    }
    .login-right {
        background: var(--body-bg, #fcfbf7);
        transition: background 0.3s;
    }
    body.dark-mode .login-right {
        background: var(--dark-bg, #18181a);
    }
    .movie-slider-container {
        position: relative;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
    }
    .movie-slider-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: opacity 0.3s ease;
    }
    .movie-slider-img.hide {
        opacity: 0;
    }
    .slider-btn {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: rgba(255, 255, 255, 0.8);
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 18px;
        cursor: pointer;
        z-index: 10;
        transition: all 0.3s ease;
    }
    .slider-btn:hover {
        background: rgba(255, 255, 255, 0.9);
        transform: translateY(-50%) scale(1.1);
    }
    .slider-btn.left {
        left: 20px;
    }
    .slider-btn.right {
        right: 20px;
    }
    .slider-indicators {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 8px;
        z-index: 10;
    }
    .slider-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.5);
        cursor: pointer;
        transition: all 0.3s ease;
    }
    .slider-dot.active {
        background: rgba(255, 255, 255, 0.9);
        transform: scale(1.2);
    }
    .login-logo-img {
        width: 80px;
        height: 80px;
        border-radius: 20px;
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 1.5rem;
        box-shadow: 0 4px 20px rgba(99, 102, 241, 0.3);
        transition: background 0.3s, box-shadow 0.3s;
    }
    body.dark-mode .login-logo-img {
        background: #232336;
        box-shadow: 0 2px 12px rgba(99,102,241,0.13);
    }
    .login-title-big {
        font-size: 3rem;
        font-family: 'Georgia', serif;
        font-weight: 600;
        color: #18181a;
        text-align: center;
        margin-bottom: 1.1rem;
        line-height: 1.1;
        transition: color 0.3s;
    }
    body.dark-mode .login-title-big {
        color: #e2e8f0;
    }
    .login-desc {
        font-size: 1.15rem;
        color: #444;
        text-align: center;
        margin-bottom: 2.5rem;
        font-family: 'Poppins', sans-serif;
        transition: color 0.3s;
    }
    body.dark-mode .login-desc {
        color: #b3b3c6;
    }
    .login-card-claude {
        background: #fff;
        border-radius: 24px;
        box-shadow: 0 4px 32px rgba(0,0,0,0.08);
        padding: 2.5rem 2.2rem 2.2rem 2.2rem;
        width: 100%;
        max-width: 400px;
        display: flex;
        flex-direction: column;
        align-items: center;
        transition: background 0.3s, box-shadow 0.3s;
    }
    body.dark-mode .login-card-claude {
        background: var(--card-bg, #232336);
        box-shadow: 0 4px 32px rgba(99,102,241,0.13);
    }
    .login-title {
        margin-bottom: 1.5rem;
        text-align: center;
        font-weight: bold;
        font-size: 2.1rem;
        color: #2c3e50;
        letter-spacing: 1px;
        font-family: 'Montserrat', 'Poppins', sans-serif;
        transition: color 0.3s;
    }
    body.dark-mode .login-title {
        color: #e2e8f0;
    }
    .form-control {
        border-radius: 10px;
        border: 1.5px solid #e0e0e0;
        padding: 0.7rem 1rem;
        font-size: 1.08rem;
        margin-bottom: 0.5rem;
        background: #fff;
        color: #18181a;
        transition: background 0.3s, color 0.3s, border-color 0.3s;
    }
    body.dark-mode .form-control {
        background: #232336;
        color: #e2e8f0;
        border-color: #6366f1;
    }
    .btn-primary {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        border: none;
        padding: 0.6rem;
        font-size: 1rem;
        border-radius: 6px;
        transition: all 0.3s ease;
    }
    body.dark-mode .btn-primary {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        color: #fff;
    }
    .form-control::placeholder {
        color: #888;
        opacity: 1;
    }
    body.dark-mode .form-control::placeholder {
        color: #b3b3c6;
        opacity: 1;
    }
    .forget-password-desc {
        text-align: center;
        color: #666;
        margin-bottom: 2rem;
        font-size: 1rem;
        line-height: 1.5;
    }
    body.dark-mode .forget-password-desc {
        color: #b3b3c6;
    }
    .back-to-login {
        text-align: center;
        margin-top: 1.5rem;
    }
    .back-to-login a {
        color: #6366f1;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s;
    }
    .back-to-login a:hover {
        color: #8b5cf6;
    }
    body.dark-mode .back-to-login a {
        color: #8b5cf6;
    }
    body.dark-mode .back-to-login a:hover {
        color: #a78bfa;
    }
</style>

<div class="login-main-container">
    <div class="login-left">
        <div class="login-card-claude">
            <div class="login-logo-img">
                <i class="fas fa-lock" style="color: white; font-size: 2rem;"></i>
            </div>
            <h1 class="login-title">Quên Mật Khẩu</h1>
            <p class="forget-password-desc">
                Nhập email của bạn để nhận hướng dẫn đặt lại mật khẩu
            </p>
            
            <form asp-action="ForgetPassword" asp-controller="Account" method="post" class="w-100">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                
                <div class="form-group">
                    <label asp-for="Email" class="form-label">Email</label>
                    <input asp-for="Email" class="form-control" placeholder="Nhập email của bạn" />
                    <span asp-validation-for="Email" class="text-danger"></span>
                </div>
                
                <button type="submit" class="btn btn-primary w-100 mt-3">
                    <i class="fas fa-paper-plane me-2"></i>
                    Gửi Hướng Dẫn
                </button>
                
                <div class="back-to-login">
                    <a asp-action="Login" asp-controller="Account">
                        <i class="fas fa-arrow-left me-1"></i>
                        Quay lại đăng nhập
                    </a>
                </div>
            </form>
        </div>
    </div>
    <div class="login-right">
        <div class="movie-slider-container">
            <button class="slider-btn left" id="sliderPrev" aria-label="Previous">&#8592;</button>
            <img id="sliderImg" class="movie-slider-img" src="" alt="Movie Poster" style="display:none;" />
            <button class="slider-btn right" id="sliderNext" aria-label="Next">&#8594;</button>
            <div class="slider-indicators" id="sliderIndicators"></div>
        </div>
    </div>
</div>

<partial name="_ToastMessages" />

<script>
    let posters = [];
    let current = 0;
    let autoSlideInterval = null;

    function showSlide(idx) {
        if (!posters.length) return;
        const img = document.getElementById('sliderImg');
        img.classList.add('hide');
        setTimeout(() => {
            img.src = posters[idx];
            img.style.display = 'block';
            img.classList.remove('hide');
        }, 200);
        // Update indicators
        const dots = document.querySelectorAll('.slider-dot');
        dots.forEach((dot, i) => dot.classList.toggle('active', i === idx));
    }

    function nextSlide() {
        current = (current + 1) % posters.length;
        showSlide(current);
    }
    function prevSlide() {
        current = (current - 1 + posters.length) % posters.length;
        showSlide(current);
    }
    function goToSlide(idx) {
        current = idx;
        showSlide(current);
    }
    function startAutoSlide() {
        if (autoSlideInterval) clearInterval(autoSlideInterval);
        autoSlideInterval = setInterval(nextSlide, 3500);
    }

    fetch('/Movie/MovieList', { headers: { 'X-Requested-With': 'XMLHttpRequest' } })
        .then(res => res.text())
        .then(html => {
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = html;
            posters = Array.from(tempDiv.querySelectorAll('img')).map(img => img.src);
            if (!posters.length) return;
            // Render indicators
            const indicators = document.getElementById('sliderIndicators');
            indicators.innerHTML = '';
            posters.forEach((_, i) => {
                const dot = document.createElement('div');
                dot.className = 'slider-dot' + (i === 0 ? ' active' : '');
                dot.onclick = () => { goToSlide(i); startAutoSlide(); };
                indicators.appendChild(dot);
            });
            // Show first slide
            current = 0;
            showSlide(current);
            startAutoSlide();
        });

    document.getElementById('sliderPrev').onclick = function() { prevSlide(); startAutoSlide(); };
    document.getElementById('sliderNext').onclick = function() { nextSlide(); startAutoSlide(); };
</script>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
} 