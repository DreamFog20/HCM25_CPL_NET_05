@model MovieTheater.ViewModels.ProfileUpdateViewModel

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "My Account";
    var activeTab = ViewData["ActiveTab"]?.ToString() ?? "Profile";
}

<!-- SIDEBAR TĨNH, KHÔNG CỐ ĐỊNH KHI CUỘN -->
<div class="container-fluid">
    <div class="row">
        <aside id="modernSidebar" class="modern-sidebar-static col-auto" style="width: 240px; min-height: 100px; background: #fff; border-radius: 0 0 18px 0; box-shadow: 2px 0 16px rgba(30,41,59,0.07); border-right: 1.5px solid #e5e7eb; padding: 0; margin: 0;">
            <div style="width:100%; display:flex; justify-content:center; align-items:center; padding-top: 18px;">
                <button id="sidebarToggle" class="hamburger-btn-static">
                    <span class="material-icons">menu</span>
                </button>
            </div>
            <nav class="sidebar-nav">
                <ul style="list-style: none; margin: 0; padding: 24px 0 0 0;">
                    <li style="margin-bottom: 8px;"><a href="#" class="sidebar-link active" data-tab="Profile"><span class="material-icons">person</span> <span>Profile</span></a></li>
                    <li style="margin-bottom: 8px;"><a href="#" class="sidebar-link" data-tab="Score"><span class="material-icons">star</span> <span>Score</span></a></li>
                    <li><a href="#" class="sidebar-link" data-tab="Voucher"><span class="material-icons">card_giftcard</span> <span>Voucher</span></a></li>
                </ul>
            </nav>
        </aside>
        <div class="col main-content" id="tabContent">
            <h3>Loading...</h3>
        </div>
    </div>
</div>

@section Scripts {
<script>
    $(document).ready(function () {
        // Toggle sidebar
        $('#sidebarToggle').click(function() {
            $('#modernSidebar').toggleClass('sidebar-hidden');
        });
        // Tab switching
        $('.sidebar-link').click(function(e) {
            e.preventDefault();
            $('.sidebar-link').removeClass('active');
            $(this).addClass('active');
            const tab = $(this).data('tab');
            // Load tab content
            $('#tabContent').html('<h3>Loading...</h3>');
            $.get(`/MyAccount/LoadTab?tab=${tab}`, function (data) {
                $('#tabContent').html(data);
            }).fail(function() {
                $('#tabContent').html('<div class="alert alert-danger">Failed to load tab content. Please try again.</div>');
            });
        });
        // Load initial tab
        const urlParams = new URLSearchParams(window.location.search);
        const initialTab = urlParams.get('tab') || 'Profile';
        $(`.sidebar-link[data-tab="${initialTab}"]`).trigger('click');
    });
</script>
<style>
        .modern-sidebar-static {
            transition: width 0.3s ease;
        }

            .modern-sidebar-static.collapsed {
                width: 80px !important;
            }

        .hamburger-btn-static {
            background: #007bff;
            border: none;
            border-radius: 8px;
            width: 40px;
            height: 40px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            color: #333;
            text-decoration: none;
            border-radius: 8px;
            margin: 4px 8px;
            transition: all 0.3s ease;
        }

            .sidebar-link:hover {
                background-color: #f8f9fa;
                color: #007bff;
            }

            .sidebar-link.active {
                background-color: #007bff;
                color: white;
            }

            .sidebar-link .material-icons {
                margin-right: 12px;
                font-size: 20px;
            }

        /* Khi sidebar collapsed */
        .collapsed .sidebar-link span:not(.material-icons) {
            display: none;
        }

        .collapsed .sidebar-link .material-icons {
            margin-right: 0;
        }

        .collapsed .sidebar-link {
            justify-content: center;
            padding: 12px;
        }

        /* Đảm bảo hamburger button luôn hiển thị */
        .hamburger-btn-static {
            position: relative;
            z-index: 1001;
        }
</style>
    <script>
        // Sidebar toggle functionality
        document.getElementById('sidebarToggle').addEventListener('click', function () {
            const sidebar = document.getElementById('modernSidebar');

            sidebar.classList.toggle('collapsed');

            // Thay đổi icon
            const icon = this.querySelector('.material-icons');
            if (sidebar.classList.contains('collapsed')) {
                icon.textContent = 'menu_open';
            } else {
                icon.textContent = 'menu';
            }
        });
    </script>
}



