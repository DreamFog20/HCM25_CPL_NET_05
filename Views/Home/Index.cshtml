@{
    ViewData["Title"] = "Home";
    var movies = ViewBag.Movies as IEnumerable<MovieTheater.Models.Movie>;
    var promotions = ViewBag.Promotions as IEnumerable<MovieTheater.Models.Promotion>;
}

<div class="container-xl py-4">
    <!-- Slideshow banner -->
    <div class="slideshow-container">
        <ul id="home_big_banner" class="slideshow"
            data-cycle-fx="fade"
            data-cycle-timeout="5000"
            data-cycle-slides="> li"
            data-cycle-pager=".home_big_banner_pager"
            data-cycle-pager-template="<span class='pager-bullet'></span>"
            data-cycle-prev=".home_big_banner_prev"
            data-cycle-next=".home_big_banner_next"
            data-cycle-swipe="true"
            data-cycle-swipe-fx="fade">
            <li class="slide-item">
                <a href="">
                    <img src="https://iguov8nhvyobj.vcdn.cloud/media/banner/cache/1/b58515f018eb873dafa430b6f9ae0c1e/9/8/980wx448h_1_-min_6.jpg" alt="Banner 1" />
                </a>
            </li>
            <li class="slide-item">
                <a href="">
                    <img src="https://iguov8nhvyobj.vcdn.cloud/media/banner/cache/1/b58515f018eb873dafa430b6f9ae0c1e/9/8/980wx448h-duoidayho.jpg" alt="Banner 2" />
                </a>
            </li>
            <li class="slide-item">
                <a href="">
                    <img src="https://i.ytimg.com/vi/8Yj61CP1Sic/maxresdefault.jpg" alt="Banner 3" />
                </a>
            </li>
            <li class="slide-item">
                <a href="">
                    <img src="https://www.bhdstar.vn/wp-content/uploads/2024/08/referenceSchemeHeadOfficeallowPlaceHoldertrueheight360ldapp.png" alt="Banner 4" />
                </a>
            </li>
        </ul>
        <button type="button" class="slideshow-prev home_big_banner_prev" aria-label="Previous slide">&#10094;</button>
        <button type="button" class="slideshow-next home_big_banner_next" aria-label="Next slide">&#10095;</button>
        <div class="home_big_banner_pager pager-container"></div>
    </div>

    <div class="mb-5"></div>

    <!-- Movie Slider -->
    <h2 class="section-title">MOVIE</h2>
    <div class="swiper movie-swiper mb-5">
        <div class="swiper-wrapper">
            @foreach (var movie in movies)
            {
                <div class="swiper-slide">
                    <div class="card movie-card h-100 shadow-sm">
                        <img src="@movie.SmallImage" class="card-img-top" alt="@movie.MovieNameEnglish">
                        <div class="card-body text-center">
                            <h5 class="card-title">@movie.MovieNameEnglish</h5>
                            <a asp-controller="Movie"
                               asp-action="Detail"
                               asp-route-id="@movie.MovieId"
                               class="btn btn-danger mt-2 px-4">
                                Book
                            </a>
                        </div>
                    </div>
                </div>
            }
        </div>
        <div class="swiper-pagination movie-pagination"></div>
        <div class="swiper-button-next movie-next"></div>
        <div class="swiper-button-prev movie-prev"></div>
    </div>

    <!-- Promotion Slider -->
    <h2 class="section-title">PROMOTION</h2>
    <div class="swiper promo-swiper mb-5">
        <div class="swiper-wrapper">
            @foreach (var promo in promotions)
            {
                <div class="swiper-slide">
                    <div class="card promo-card h-100 shadow-sm">
                        <img src="@promo.Image" class="card-img-top" alt="Promotion">
                        <div class="card-body text-center">
                            <p class="card-text">@promo.Detail</p>
                        </div>
                    </div>
                </div>
            }
        </div>
        <div class="swiper-pagination promo-pagination"></div>
        <div class="swiper-button-next promo-next"></div>
        <div class="swiper-button-prev promo-prev"></div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Initialize cycle2 slideshow with explicit options
            $('#home_big_banner').cycle({
                fx: 'fade',
                timeout: 5000,
                slides: '> li',
                pager: '.home_big_banner_pager',
                pagerTemplate: '<span class="pager-bullet"></span>',
                prev: '.home_big_banner_prev',
                next: '.home_big_banner_next',
                swipe: true,
                swipeFx: 'fade',
                log: false,
                speed: 1000,
                pauseOnHover: true,
                allowWrap: true,
                manualSpeed: 1000,
                manualTrump: true
            });

            // Add click event handlers as backup
            $('.home_big_banner_prev').on('click', function() {
                $('#home_big_banner').cycle('prev');
            });
            
            $('.home_big_banner_next').on('click', function() {
                $('#home_big_banner').cycle('next');
            });
        });

        var movieSwiper = new Swiper('.movie-swiper', {
            effect: 'coverflow',
            grabCursor: true,
            centeredSlides: true,
            slidesPerView: 4,
            spaceBetween: 30,
            coverflowEffect: {
                rotate: 30,
                stretch: 0,
                depth: 200,
                modifier: 1,
                slideShadows: true,
            },
            navigation: {
                nextEl: '.movie-next',
                prevEl: '.movie-prev',
            },
            pagination: {
                el: '.movie-pagination',
                clickable: true,
            },
            breakpoints: {
                0: { slidesPerView: 1 },
                576: { slidesPerView: 2 },
                992: { slidesPerView: 4 }
            }
        });

        var promoSwiper = new Swiper('.promo-swiper', {
            slidesPerView: 4,
            spaceBetween: 30,
            navigation: {
                nextEl: '.promo-next',
                prevEl: '.promo-prev',
            },
            pagination: {
                el: '.promo-pagination',
                clickable: true,
            },
            breakpoints: {
                0: { slidesPerView: 1 },
                576: { slidesPerView: 2 },
                992: { slidesPerView: 4 }
            }
        });
    </script>
          

}
<style>
body {
    background: #f8f9fa;
}
.section-title {
    font-family: 'Montserrat', monospace;
    font-size: 2.2rem;
    letter-spacing: 2px;
    font-weight: bold;
    color: #e50914;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 16px;
    margin-bottom: 32px;
}
.section-title:before, .section-title:after {
    content: '';
    flex: 1;
    border-bottom: 2px solid #e50914;
    margin: 0 16px;
    opacity: 0.2;
}
.swiper {
    padding-bottom: 40px;
}
.movie-card, .promo-card {
    border-radius: 18px;
    overflow: hidden;
    transition: transform 0.2s, box-shadow 0.2s;
    background: #fff;
    box-shadow: 0 2px 12px rgba(0,0,0,0.07);
    border: none;
}
.movie-card:hover, .promo-card:hover {
    transform: translateY(-8px) scale(1.03);
    box-shadow: 0 8px 32px rgba(229,9,20,0.18);
}
.card-img-top {
    height: 340px;
    object-fit: cover;
    border-bottom: 1px solid #eee;
    background: #f2f2f2;
}
.promo-card .card-img-top {
    height: 180px;
}
.card-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: #222;
    margin-bottom: 0.5rem;
}
.card-text {
    font-size: 1rem;
    color: #444;
}
.btn-danger {
    background: #e50914;
    border: none;
    font-weight: 600;
    border-radius: 8px;
    transition: background 0.2s;
}
.btn-danger:hover {
    background: #b0060f;
}
.swiper-button-next, .swiper-button-prev {
    color: #fff;
    background: #e50914;
    border-radius: 50%;
    box-shadow: 0 2px 8px rgba(0,0,0,0.12);
    width: 48px;
    height: 48px;
    top: 45%;
    opacity: 0.95;
    transition: background 0.2s;
}
.swiper-button-next:hover, .swiper-button-prev:hover {
    background: #b0060f;
}
.swiper-button-next:after, .swiper-button-prev:after {
    font-size: 1.7rem;
    font-weight: bold;
}
.swiper-pagination-bullet {
    background: #e50914;
    opacity: 0.4;
}
.swiper-pagination-bullet-active {
    background: #e50914;
    opacity: 1;
}

/* Slideshow Styles */
.slideshow-container {
    position: relative;
    width: 100%;
    margin: 0 auto;
    overflow: hidden;
    border-radius: 16px;
    box-shadow: 0 4px 24px rgba(0,0,0,0.1);
    background: #000;
}

.slideshow {
    margin: 0;
    padding: 0;
    list-style: none;
    width: 100%;
    height: 0;
    padding-bottom: 45%; /* 16:9 aspect ratio */
    position: relative;
}

.slide-item {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 0.5s ease;
}

.slide-item.cycle-slide-active {
    opacity: 1;
}

.slide-item a {
    display: block;
    width: 100%;
    height: 100%;
}

.slide-item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.slideshow-controls {
    position: absolute;
    top: 50%;
    width: 100%;
    transform: translateY(-50%);
    z-index: 10;
    display: flex;
    justify-content: space-between;
    padding: 0 20px;
}

.slideshow-prev,
.slideshow-next {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 48px;
    height: 48px;
    background: rgba(229, 9, 20, 0.85);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    z-index: 30;
}

.slideshow-prev {
    left: 20px;
}

.slideshow-next {
    right: 20px;
}

.slideshow-prev:hover,
.slideshow-next:hover {
    background: #e50914;
    transform: translateY(-50%) scale(1.1);
}

.slideshow-prev i,
.slideshow-next i {
    font-size: 1.2rem;
    pointer-events: none;
}

.pager-container {
    position: absolute;
    bottom: 20px;
    width: 100%;
    display: flex;
    justify-content: center;
    gap: 8px;
    z-index: 10;
}

.pager-bullet {
    width: 10px;
    height: 10px;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.3s ease;
}

.pager-bullet.cycle-pager-active {
    background: #e50914;
    transform: scale(1.2);
}

@@media (max-width: 768px) {
    .slideshow {
        padding-bottom: 56.25%; /* 16:9 aspect ratio for mobile */
    }
    
    .slideshow-prev,
    .slideshow-next {
        width: 40px;
        height: 40px;
    }
    
    .pager-container {
        bottom: 12px;
    }
    
    .pager-bullet {
        width: 8px;
        height: 8px;
    }
}
</style>